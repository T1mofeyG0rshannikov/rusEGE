{{ define "login" }}
<div id="login" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal(this)">&times;</span>
        <h2>Логин</h2>
        <form onsubmit="submitLogin(event, this)">
            <label for="name">Username:</label><br>
            <input type="text" id="name" name="name"><br><br>

            <label for="password">Пароль:</label><br>
            <input type="password" id="password" name="password"><br><br>

            <span class="error"></span><br>

            <a onclick="openRegisterForm(event)">Зарегистрироваться</a><br>
            <input style="margin: 0; width: 100%;" class="button" type="submit" value="Отправить">
        </form>
    </div>
</div>

<script>
    function submitLogin(event, form){
        event.preventDefault();

        const data = new FormData(form)

        console.log(data)

        fetch("/api/login", {
            method: "POST",
            body: data
        }).then(response => {
            if (!response.ok){
                response.json().then(response => {
                    console.log(response)
                    form.querySelector(".error").textContent = response.message
                })
            }
            else{
                response.json().then(response => {
                    console.log(response)
                    setAuthToken(response.access_token, response.refresh_token)
                })
            }
        })
    }
</script>
{{ end }}