{{ define "register" }}
<div id="register" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal(this)">&times;</span>
        <h2>Регистрация</h2>
        <form onsubmit="submitRegister(event, this)">
            <label for="name">Username:</label><br>
            <input type="text" id="name" name="name"><br><br>

            <label for="password">Пароль:</label><br>
            <input type="password" id="password" name="password"><br><br>

            <label for="password">Повтор пароля:</label><br>
            <input type="password" id="repeat-password" name="repeat-password"><br><br>

            <a onclick="openLoginForm(event)">Войти в аккаунт</a><br>
            <input style="margin: 0; width: 100%;" class="button" type="submit" value="Отправить">
        </form>
    </div>
</div>

<script>
    function submitRegister(event, form){
        event.preventDefault();

        const data = new FormData(form)

        console.log(data)

        fetch("/api/register", {
            method: "POST",
            body: data
        }).then(response => {
            if (!response.ok){
                response.json().then(response => {
                    console.log(response)
                    form.querySelector(".error").textContent = response.message
                })
            }
            else{
                response.json().then(response => {
                    console.log(response)
                    setAuthToken(response.access_token, response.refresh_token)
                })
            }
        })
    }
</script>
{{ end }}
